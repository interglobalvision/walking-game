var app={initialize:function(){this.bindEvents()},bindEvents:function(){document.addEventListener("deviceready",this.onDeviceReady,!1),document.addEventListener("DOMContentLoaded",this.onContentLoaded,!1),document.addEventListener("backbutton",this.onBackKeyDown,!1)},onDeviceReady:function(){app.receivedEvent("deviceready")},onContentLoaded:function(){FastClick.attach(document.body)},onBackKeyDown:function(){return!0},receivedEvent:function(t){console.log("Received Event: "+t),$("#game-username").html(Game.getUsername()),$("#game-points").html(Game.getPoints()),$("#game-gems").html(Game.getGems()),$("#game-progress").html(Game.getProgressPercent())}};app.initialize(),Compass={stepSize:8e-4,$blackout:$("#blackout"),$radar:$("#radar"),$angle:$("#angle"),$mapStage:$(".map-stage"),$compass:$("#compass"),$mapFloor:$(".map-floor"),$compassContainer:$("#compass-container"),$mapGoal:$("#map-goal"),$mapSky:$(".map-sky"),$mapGoalContainer:$("#map-goal-container"),$mapOrientation:$(".map-orientation"),watchId:{orientation:null,position:null},origin:{lat:null,lng:null},destiny:{lat:null,lng:null},position:{lat:null,lng:null},modifiedDistance:0,minDistance:.0023,maxDistance:.0026,destinyThresholdRadius:.3,totalDistance:0,getDistanceInKm:function(t,e){var n=this,o=6371,a=n.deg2rad(e.lat-t.lat),i=n.deg2rad(e.lng-t.lng),r=Math.sin(a/2)*Math.sin(a/2)+Math.cos(n.deg2rad(t.lat))*Math.cos(n.deg2rad(e.lat))*Math.sin(i/2)*Math.sin(i/2),s=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)),l=o*s;return l},rad2deg:function(t){return 57.29577951308232*t},deg2rad:function(t){return t*(Math.PI/180)},getRandomDistance:function(t,e){var n=Math.random()>=.5,o=Math.random()*(e-t)+t;return n&&(o*=-1),o},getAngle:function(t,e,n){var o=this,a=Math.sqrt(Math.pow(e.lng-t.lng,2)+Math.pow(e.lat-t.lat,2)),i=Math.sqrt(Math.pow(e.lng-n.lng,2)+Math.pow(e.lat-n.lat,2)),r=Math.sqrt(Math.pow(n.lng-t.lng,2)+Math.pow(n.lat-t.lat,2));return o.rad2deg(Math.acos((i*i+a*a-r*r)/(2*i*a)))},updatePosition:function(t){var e=this;e.position=t,e.reference={lat:t.lat+e.minDistance,lng:t.lng};var n=e.getDistanceInKm(e.position,e.destiny),o=100*(n-e.destinyThresholdRadius)/e.totalDistance,a=100-o,i=.75*a,r=.01*a;i<0&&(i=0),r<.01&&(r=.01),e.$mapFloor.css({"-webkit-transform":"translateY("+i+"%)",transform:"translateY("+i+"%)"}),e.$mapGoal.css({"-webkit-transform":"scale("+r+")",transform:"scale("+r+")"}),n<e.destinyThresholdRadius&&(Game.setStepsPot(e.distanceToSteps(e.totalDistance)),e.stop())},distanceToSteps:function(t){var e=this;return Math.floor(t/e.stepSize)},updateOrientation:function(t){var e=this,n=t*-1,o=e.getAngle(e.reference,e.position,e.destiny);e.position.lng>e.destiny.lng&&(o=360-o);var a=o+n;a<0&&(a+=360);var i=a;a>180&&(i=a-360);var r=i/.7;r>75?r=75:r<-75&&(r=-75);var s=a/7.2;a>180&&(s=(a-180)/7.2-25),e.$mapGoalContainer.css({"-webkit-transform":"translateX("+r+"%)",transform:"translateX("+r+"%)"}),e.$mapOrientation.css({"-webkit-transform":"translateX("+s+"%)",transform:"translateX("+s+"%)"}),e.$compass.css({"-webkit-transform":"rotate("+a+"deg)",transform:"rotate("+a+"deg)"})},skyColor:function(){var t=this,e=new Date;if(e){var n,o=e.getHours();n=o>4&&o<10?"rgb(100, 160, 255)":o>9&&o<17?"rgb(145, 205, 242)":o>16&&o<22?"rgb(10, 40, 95)":"rgb(0, 20, 60)",t.$mapSky.css("background-color",n)}},mapTheme:function(){var t=this;t.$mapStage.addClass("world-"+Game.getWorld())},startGeoWatchers:function(){var t=this;t.watchId.position=navigator.geolocation.watchPosition(function(e){t.updatePosition({lat:e.coords.latitude,lng:e.coords.longitude})},function(t){alert(t)},{enableHighAccuracy:!0}),navigator.userAgent.match(/(iPhone|iPod|Android)/)?t.watchId.orientation=navigator.compass.watchHeading(function(e){t.updateOrientation(e.magneticHeading)}):$(window).bind("deviceorientation.compassOrientation",function(){t.updateOrientation(event.alpha)})},stopGeoWatchers:function(){var t=this;navigator.geolocation.clearWatch(t.watchId.position),navigator.compass.clearWatch(t.watchId.orientation)},stop:function(){var t=this;t.stopGeoWatchers(),$(window).unbind(".compassOrientation"),Game.nextMinigame()},resetDestiny:function(t){var e=this;e.stopGeoWatchers(),$(window).unbind(".compassOrientation"),Game.setNewPoints(Utilities.Number.getRandomInt(-100,0)),e.init(),t&&t()},init:function(){var t=this;t.modifiedDistance=Game.modifyDifficulty(1e-4),t.minDistance=t.minDistance+t.modifiedDistance,t.maxDistance=t.maxDistance+t.modifiedDistance,navigator.geolocation&&window.DeviceOrientationEvent?navigator.geolocation.getCurrentPosition(function(e){var n=e.coords;t.origin.lat=n.latitude,t.origin.lng=n.longitude,t.destiny.lat=n.latitude+t.getRandomDistance(t.minDistance,t.maxDistance),t.destiny.lng=n.longitude+t.getRandomDistance(t.minDistance,t.maxDistance),t.totalDistance=t.getDistanceInKm({lat:n.latitude,lng:n.longitude},t.destiny)-t.destinyThresholdRadius,t.updatePosition({lat:n.latitude,lng:n.longitude}),t.skyColor(),t.mapTheme(),t.startGeoWatchers(),1===parseInt(window.localStorage.getItem("firstwalk"))?t.$blackout.animate({opacity:0},1e3,"linear",function(){Utilities.Dialog.read(Home.dialog,function(){$("#coach-container").animate({opacity:0},1e3,"linear"),window.localStorage.setItem("firstwalk",0)})}):($("#coach-container").css("opacity",0),t.$blackout.animate({opacity:0},1e3,"linear"))}):WalkingError.unsupportedGPS()}},WalkingError={unsupportedCompensation:1e3,throw:function(t,e){console.log(t),alert(e)},unsupported:function(t){var e=this;t||(t="the required technology"),console.log(t+" is unsupported on this device"),alert("Sorry "+Game.getUsername()+", but your device does not support "+t+"!! But I will give you a consolation prize... Here's "+e.unsupportedCompensation+" points. Now get outta here!"),Game.gameComplete(e.unsupportedCompensation)},unsupportedGPS:function(){console.log("Fuck. No GPS"),alert("Sorry "+Game.getUsername()+", but your device does not support GPS or you have denied the app access to your location. You can't go walking if I don't know where you are. Open the Walking Game settings on your device and allow location access!!")}},Game={minigames:["hardcoreloud","favfood","twisterfingers","tippyswitch","shakyvibrate","math","supertap","reset","colorsnap","1percent","vibeystopper","jankenpon","worldtraveler","medit8"],worlds:["Desert","City","Arctic","Jungle"],gameAttempts:2,shareTitle:function(t){return"WOOAAAAHH! U HAVE AN AWESOME SCORe 0F "+t+" POIIINTSSS BRAAAHHH"},shareSubject:"Subject: I did this on Walking Game. The most tiring phone game ever made",shareUrl:"http://interglobal.vision/",createUser:function(t,e){var n=this;window.localStorage.setItem("username",t),window.localStorage.setItem("points",0),window.localStorage.setItem("gems",0),window.localStorage.setItem("progress",0),window.localStorage.setItem("distance",0),window.localStorage.setItem("loops",0),window.localStorage.setItem("world",0),window.localStorage.setItem("firstwalk",1),window.localStorage.setItem("rank",n.newRank()),n.setupLoop(),e()},getUsername:function(){return window.localStorage.getItem("username")},setupLoop:function(){var t=this;console.log("Setting up loop"),t.setProgress(0),t.setLoopOrder(Utilities.Misc.shuffleArray(t.minigames))},getProgress:function(){var t=parseInt(window.localStorage.getItem("progress"));return(null===t||isNaN(t))&&(t=0),t},setProgress:function(t){window.localStorage.setItem("progress",t)},getProgressPercent:function(){var t=this,e=t.getProgress();return e/this.minigames.length},setTotalDistance:function(t){var e=this,n=e.getTotalDistance(),t=parseFloat(t);window.localStorage.setItem("distance",n+t)},setStepsPot:function(t){window.localStorage.setItem("stepsPot",t)},getStepsPot:function(){return window.localStorage.getItem("stepsPot")?parseFloat(window.localStorage.getItem("stepsPot")):0},getTotalDistance:function(){return window.localStorage.getItem("distance")?parseFloat(window.localStorage.getItem("distance")):0},getTotalDistanceString:function(){var t=this,e=t.getTotalDistance(),n=[[.0046,"anacondas"],[.025,"blue whales"],[.828,"Burj Khalifas"],[.006,"elephant trunks"],[.00206,"Ebenezer Places"],[385000.6,"Lunar distances"],[40075,"Earth circumferences"]],o=n[Utilities.Number.getRandomInt(0,n.length-1)],a=e/o[0];return a>1&&(a=a.toFixed(3)),a+" "+o[1]},getLoops:function(){var t=parseInt(window.localStorage.getItem("loops"));return(null===t||isNaN(t))&&(t=0),t},setLoops:function(t){window.localStorage.setItem("loops",t)},setLoopOrder:function(t){window.localStorage.setItem("loopOrder",t)},getLoopOrder:function(){var t=window.localStorage.getItem("loopOrder");return t?t.split(","):[]},modifyDifficulty:function(t){var e=this,n=e.getLoops();return n*t},nextMinigame:function(){var t=this,e=t.getProgress(),n=t.getLoopOrder();console.log("Loading next minigame"),console.log("Current progress index",e),console.log("Game to load",n[e]),Router.go("/games/"+n[e]+"/")},finishLoop:function(){var t=this,e=t.getLoops();console.log("Finished loop"),t.setLoops(e+1),t.nextWorld(),t.setRank(),console.log("Loops so far",e),t.setupLoop(),Router.go("/scenes/levelup/")},nextWorld:function(){var t=this,e=t.getWorld(),n=e+1;n===t.worlds.length?window.localStorage.setItem("world",0):window.localStorage.setItem("world",n)},getWorld:function(){return parseInt(window.localStorage.getItem("world"))},getWorldName:function(){var t=this,e=t.getWorld();return t.worlds[e]},setRank:function(){var t=this;window.localStorage.setItem("rank",t.newRank())},newRank:function(){return Utilities.Word.getAdj(!0,!0)+" "+Utilities.Word.getNoun(!1,!0)},getRank:function(){return window.localStorage.getItem("rank")},gameFail:function(t,e){var n=this;n.gameAttempts>1?(n.gameAttempts--,t()):e()},gameComplete:function(t){var e=this,n=e.getProgress();e.setProgress(n+1),t&&e.setNewPoints(t),n+1===e.minigames.length?e.finishLoop():Router.go("/pages/compass/")},getPoints:function(){var t=parseInt(window.localStorage.getItem("points"));return(null===t||isNaN(t))&&(t=0),t},setPoints:function(t){window.localStorage.setItem("points",t)},setNewPoints:function(t){var e=this,t=parseInt(t),n=e.getPoints(),o=e.getGems();if(t>0){var a=Math.log(o+1)+1,i=Math.round(t*a);e.setPoints(n+i)}else e.setPoints(n+t)},resetPoints:function(){var t=this;t.setPoints(0)},getGems:function(){var t=parseInt(window.localStorage.getItem("gems"));return(null===t||isNaN(t))&&(t=0),t},setGems:function(t){window.localStorage.setItem("gems",t)},setNewGems:function(t){var e=this,t=parseInt(t),n=e.getGems();e.setGems(n+t)},shareWithOptions:function(){var t=this,e=t.getPoints();window.plugins.socialsharing.share(t.shareTitle(e),t.shareSubject,"http://puu.sh/mTFtM/242a0fa967.png",t.shareUrl,function(){console.log("share ok")},function(t){console.log("share failed"),console.log(t),alert("something went wrong")})}},Menu={$blackout:$("#blackout"),$menu:$(".menu"),$menuButton:$("#map-menu-button"),$menuPoints:$("#menu-points"),$menuDistance:$("#menu-distance"),$menuRank:$("#menu-rank"),$menuWorld:$("#menu-world"),$buttonShare:$('[data-ref="menu-share"]'),$buttonOpenSub:$(".open-sub-menu"),$buttonCloseSub:$(".close-sub-menu"),howtoGreeting:"<p>dear "+Game.getUsername()+",</p>",resetDestinyDialog:["What? You lost? Pshh...","Ok, I'll set a new walking goal for you, "+Game.getUsername()+"...","...and imma take some points off your score!"],$resetDestiny:$('[data-ref="menu-reset-destiny"]'),$devMenu:$('[data-ref="dev-menu"]'),$devEnd:$('[data-ref="dev-end-map"]'),toggleMenu:function(){var t=this;t.closeSubMenu(),t.$menu.toggle("fast")},init:function(){var t=this;t.$menuPoints.html(Game.getPoints()),t.$menuDistance.html(Game.getTotalDistanceString()),t.$menuWorld.html(Game.getWorldName()),t.$menuRank.html(Game.getRank()),$(".howto-text").prepend(t.howtoGreeting),t.$menuButton.on("click",function(){t.toggleMenu()}),t.$buttonShare.on("click",function(t){t.preventDefault(),Game.shareWithOptions()}),t.$buttonOpenSub.on("click",function(e){e.preventDefault(),t.openSubMenu($(this).attr("data-ref"))}),t.$buttonCloseSub.on("click",function(e){e.preventDefault(),t.closeSubMenu()}),t.$resetDestiny.on("click",function(e){e.preventDefault(),t.toggleMenu(),Utilities.Dialog.read(t.resetDestinyDialog,function(){Compass.resetDestiny(function(){t.$menuPoints.html(Game.getPoints())})})}),t.$devMenu.on("click",function(t){t.preventDefault(),Router.go("/pages/dev/")}),t.$devEnd.on("click",function(t){t.preventDefault(),Compass.stop()})},openSubMenu:function(t){$("#menu-main").addClass("show-sub-menu"),$("#"+t).addClass("show-sub-menu")},closeSubMenu:function(){$("#menu-main").removeClass("show-sub-menu"),$(".sub-menu").removeClass("show-sub-menu")}},Router={init:function(){var t=this,e=/(.+?(?:www))/;t.basePath=e.exec(window.location.href),"browser"===window.cordova.platformId?t.isBrowser=!0:t.isBrowser=!1},go:function(t){var e=this;e.isBrowser?window.location=t:window.location=e.basePath[0]+t+"index.html"}},Router.init(),Utilities={},Utilities.Color={isNeighborColor:function(t,e,n){return void 0==n&&(n=32),Math.abs(t[0]-e[0])<=n&&Math.abs(t[1]-e[1])<=n&&Math.abs(t[2]-e[2])<=n},hslToRgb:function(t,e,n){var o,a,i;if(0==e)o=a=i=n;else{var r=function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t},s=n<.5?n*(1+e):n+e-n*e,l=2*n-s;o=r(l,s,t+1/3),a=r(l,s,t),i=r(l,s,t-1/3)}return[Math.round(255*o),Math.round(255*a),Math.round(255*i)]}},Utilities.Dialog={$target:$(".text-box-dialog"),$parent:$("#dialog"),$skip:void 0,interval:33,arrayIndex:0,lineIndex:0,lineTimer:0,outputText:"",inProgress:!1,read:function(t,e){var n=this;n.$parent=$("#dialog"),n.$target=$(".text-box-dialog"),n.dialogArray=t,n.arrayIndex=0,n.$parent.show(),n.inProgress=!0,n.$parent.append('<div id="dialog-skip"></div>'),n.$skip=$("#dialog-skip"),n.$skip.off("click.dialogRead").on({"click.dialogRead":function(){n.lineTimer>0?n.skipLine():n.arrayIndex===n.dialogArray.length-1?n.finish(e):(n.arrayIndex++,n.readLine())}}),n.readLine()},readLine:function(){var t=this,e=t.dialogArray[t.arrayIndex];t.lineIndex=0,t.$target.html(""),t.outputText="",t.lineTimer=setInterval(function(){t.lineIndex<e.length?(t.outputText+=e[t.lineIndex],t.$target[0].innerHTML=t.outputText,t.lineIndex++):(t.clearLineInterval(),t.$target.append('<a class="text-box-next">&rarr;</a>'))},t.interval)},clearLineInterval:function(){var t=this;clearInterval(t.lineTimer),t.lineTimer=0},skipLine:function(){var t=this;t.clearLineInterval(),t.$target.html(t.dialogArray[t.arrayIndex]),t.$target.append('<a class="text-box-next">&rarr;</a>')},finish:function(t){var e=this;e.$parent.hide(),e.inProgress=!1,e.$target.html(""),e.$skip.remove(),t&&t()}},Utilities.Misc={shuffleArray:function(t){for(var e,n,o=t.length;o>0;)n=Math.floor(Math.random()*o),o--,e=t[o],t[o]=t[n],t[n]=e;return t},vibrate:function(t){var e=1e3;t&&(e=t),navigator.vibrate?navigator.vibrate(e):console.log("no vibrate support")}},Utilities.Number={getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},roundFloat:function(t){return t=1e3*(t+1e-5),t=Math.floor(t),t/=1e3}},Utilities.Word={adjs:[],nouns:[],init:function(t,e){var n=this;n.adjs=t,n.nouns=e},getWord:function(t,e,n){var o=this,a="adj"==t?o.adjs:o.nouns,i=a[Math.floor(Math.random()*a.length)];return n&&(i=i.charAt(0).toUpperCase()+i.slice(1)),e&&(i=o.isVowel(i[0])?"an "+i:"a "+i),i},getAdj:function(t,e){var n=this;return n.getWord("adj",t,e)},getNoun:function(t,e){var n=this;return n.getWord("noun",t,e)},isVowel:function(t){return/[aeiouAEIOU]/.test(t)}},Utilities.Word.init(Adjs,Nouns);
//# sourceMappingURL=index.min.js.map
